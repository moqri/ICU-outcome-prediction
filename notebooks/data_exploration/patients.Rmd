---
title: "Exploring Patient Table"
output: rmarkdown::github_document
---
Author: [Mahdi Moqri](https://www.moqri.com/)

The patinet table is a core part of the eICU-CRD and contains all information related to tracking patient unit stays. The table also contains patient demographics and hospital level information.

```{r include=FALSE}
data_folder='/Users/mahdimoqri/data/eicu/csv'
```

### Loading libraries
```{r message=FALSE}
library(data.table)
library(dplyr)
library(magrittr)
library(plyr)
library(knitr)
library(ggplot2)

```

### Examining the patient table
The uniquePid column identifies a single patient across multiple stays. Let's look at a single uniquepid.

```{r}
# data_folder is the local path to your data
df=fread(file.path(data_folder,'patient.csv'))
cols=c('uniquepid', 'gender', 'age', 'ethnicity','hospitaldischargestatus')
kable(head(df %>% select(cols)))
```
### Age
```{r message=FALSE, warning=FALSE}
df %<>% mutate(age_impute= (ifelse(age=='> 89',90, as.numeric(age))))
age=df[!is.na(df$age_impute),]$age_impute
hist(age)
median(age)
```

### Gender
```{r}
gender=table(df$gender)[c('Female','Male')]
gender
pie(gender)

```

### Ethnicity
```{r, catche=TRUE}
df_ethnicity =df %>% subset(ethnicity!='')
ethnicity=df_ethnicity$ethnicity
kable(table(ethnicity))
barchart(table(ethnicity))
```

### Status at discharge
```{r}
unit_discharge=df$unitdischargestatus
table(unit_discharge)
pie(table(unit_discharge))
hostpial_discharge=df$hospitaldischargestatus
kable(table(hostpial_discharge))
pie(table(hostpial_discharge))
```





